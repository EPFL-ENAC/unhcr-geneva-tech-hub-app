{"author":{"id":"66400d69fd0db6ea8efdb73c4a9d460d14336e0b82d36e3925bef0417af0584e"},"ops":[{"type":6,"timestamp":1667981986,"nonce":"k6k5ynNucBTnvkbGnUPyqg3gWsI=","metadata":{"github-id":"UCE_lAHOGxS9Oc5V7YiTzjbdBO8"},"target":"3ac0ae1237e0b179321c2549460f2dabafb564b91b0c9e4e367034929ce5c755","message":"### Is there an existing issue for this?\n\n- [X] I have searched the existing issues (fixing bug introduced by first feature in #109\n\n### TODOs:\n- [ ] Correct the formulas for Diesel and Petrol trucking\n\n### Current Behavior\n\nFormulas for computing the CO2 eq for trucking using litres instead of km was not correct\n\n### Expected Behavior\n\nWe should use the formulas describe here: https://github.com/EPFL-ENAC/unhcr-geneva-tech-hub-app/issues/109#issuecomment-1307459112\n\nas follow:\nThe CO2equivalent is calculated directly from the litres input using the *_L factors:\n\nInput 1: litres of diesel per year = D_L\nInput 2: litres of petrol / gas per year = G_L\n\nCO2_WSH_D=REF_WSH_D_L * D_L/1000 (diesel calculation, answer in CO2eq/yr)\nCO2_WSH_G=REF_WSH_G_L * G_L/1000 (diesel calculation, answer in CO2eq/yr)\n\n### Steps To Reproduce\n\n_No response_\n\n### Environment\n\n```markdown\n- OS:\n- Node:\n- npm:\n```\n\n\n### Anything else?\n\n_No response_","files":null},{"type":5,"timestamp":1667981915,"nonce":"R49sU42pGP5m/ZlAqg6R0Tv05WU=","metadata":{"github-id":"LE_lADOGxS9Oc5V7YiTzwAAAAHPLEZb"},"added":["bug"],"removed":[]},{"type":5,"timestamp":1667981915,"nonce":"scdFzDMkc+y3+qnLXcmaDYH21vg=","metadata":{"github-id":"LE_lADOGxS9Oc5V7YiTzwAAAAHPLEZd"},"added":["triage"],"removed":[]},{"type":5,"timestamp":1667982183,"nonce":"VHGDHrw7kCIVgQUEDZIeOCZ/o/s=","metadata":{"github-id":"LE_lADOGxS9Oc5V7YiTzwAAAAHPLMfu"},"added":["ghg"],"removed":[]},{"type":5,"timestamp":1668516762,"nonce":"9pcHng85ItlycA9d7trhcm7ZGmE=","metadata":{"github-id":"UNLE_lADOGxS9Oc5V7YiTzwAAAAHRu2-T"},"added":[],"removed":["triage"]},{"type":2,"timestamp":1668516797,"nonce":"xPVeBgALgSsw+n7ohNT8Z413zUM=","metadata":{"github-id":"RTE_lADOGxS9Oc5V7YiTzwAAAAHRu4De"},"title":"add correct formulas for wash trucking","was":"correct formulas for wash trucking"},{"type":2,"timestamp":1668516830,"nonce":"qO/CAjCfyb2LF2xlWRwuTO4xmzk=","metadata":{"github-id":"RTE_lADOGxS9Oc5V7YiTzwAAAAHRu5D6"},"title":"fix formulas for wash trucking","was":"add correct formulas for wash trucking"},{"type":2,"timestamp":1668516835,"nonce":"Y0wexJJ9G+icu3U4DUjVUORhugI=","metadata":{"github-id":"RTE_lADOGxS9Oc5V7YiTzwAAAAHRu5RJ"},"title":"correct formulas for wash trucking","was":"fix formulas for wash trucking"},{"type":5,"timestamp":1668516908,"nonce":"UyT+YIaZX+rv+67KHEIXIp4VQfA=","metadata":{"github-id":"LE_lADOGxS9Oc5V7YiTzwAAAAHRu7hJ"},"added":["wash-trucking"],"removed":[]},{"type":3,"timestamp":1668519430,"nonce":"ij9A4UeMOLba3HmAW9nEAsoP6yc=","metadata":{"github-id":"IC_kwDOGxS9Oc5OZjhl","github-url":"https://github.com/EPFL-ENAC/unhcr-geneva-tech-hub-app/issues/135#issuecomment-1315321957"},"message":"@ctobin111 By the way.\nI'm using the same factor for km and diesel (since that's what we decided). But it seems a bit weird.\n\nWhy don't I use the REF_WSH_D anymore for the KM diesel ? I should have a REF_WSH_G for gaz I guess? and not use the  same factor since one is for km and the other for litres\n\n- Before\n```javascript\n    const washFactor =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D_L.value : REF_WSH_G_L.value;\n\n    if (washInput.US_UNI === \"KM\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = res.TR_NUM * washInput.TOT_WS * 2;\n      res.CO2_WSH_TRB = (washFactor * res.TR_DIST) / 1000;\n      return res;\n    }\n    if (washInput.US_UNI === \"LITRES\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = 0; // the DIST is unknown since we only have the number of litres\n      res.CO2_WSH_TRB = (washFactor * washInput.LIT_WS) / 1000;\n      return res;\n    }\n    ```\n- What I'm proposing\n```javascript\n    const washFactorKM =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D.value : REF_WSH_G.value;\n    if (washInput.US_UNI === \"KM\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = res.TR_NUM * washInput.TOT_WS * 2;\n      res.CO2_WSH_TRB = (washFactorKM * res.TR_DIST) / 1000;\n      return res;\n    }\n\n    const washFactorL =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D_L.value : REF_WSH_G_L.value;\n    if (washInput.US_UNI === \"LITRES\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = 0; // the DIST is unknown since we only have the number of litres\n      res.CO2_WSH_TRB = (washFactorL * washInput.LIT_WS) / 1000;\n      return res;\n    }\n```   \n\nWitch a REF_WSH_G.value factor of 0.22 (from the excel file)","files":null},{"type":6,"timestamp":1668519447,"nonce":"Me6qLGNt2sQIWH+RdRBKyE7cKpM=","metadata":{"github-id":"UCE_lALOGxS9Oc5OZjhlzimO0Ec"},"target":"b34da01bd7b133dfa0b0d87fc2319de9902c0da7cd294793ee3b821dba8f7477","message":"@ctobin111 By the way.\nI'm using the same factor for km and diesel (since that's what we decided). But it seems a bit weird.\n\nWhy don't I use the REF_WSH_D anymore for the KM diesel ? I should have a REF_WSH_G for gaz I guess? and not use the  same factor since one is for km and the other for litres\n\n- Before\n```javascript\n    const washFactor =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D_L.value : REF_WSH_G_L.value;\n\n    if (washInput.US_UNI === \"KM\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = res.TR_NUM * washInput.TOT_WS * 2;\n      res.CO2_WSH_TRB = (washFactor * res.TR_DIST) / 1000;\n      return res;\n    }\n    if (washInput.US_UNI === \"LITRES\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = 0; // the DIST is unknown since we only have the number of litres\n      res.CO2_WSH_TRB = (washFactor * washInput.LIT_WS) / 1000;\n      return res;\n    }\n\n```\n- What I'm proposing\n```javascript\n    const washFactorKM =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D.value : REF_WSH_G.value;\n    if (washInput.US_UNI === \"KM\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = res.TR_NUM * washInput.TOT_WS * 2;\n      res.CO2_WSH_TRB = (washFactorKM * res.TR_DIST) / 1000;\n      return res;\n    }\n\n    const washFactorL =\n      washInput.TR_TYP === DIESEL ? REF_WSH_D_L.value : REF_WSH_G_L.value;\n    if (washInput.US_UNI === \"LITRES\") {\n      res.TR_NUM = Math.ceil(washInput.WACL / washInput.TR_VOL);\n      res.TR_DIST = 0; // the DIST is unknown since we only have the number of litres\n      res.CO2_WSH_TRB = (washFactorL * washInput.LIT_WS) / 1000;\n      return res;\n    }\n```   \n\nWitch a REF_WSH_G.value factor of 0.22 (from the excel file)","files":null}]}